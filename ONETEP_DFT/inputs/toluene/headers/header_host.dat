! 14.11.2019 Lennart Gundelach 
! USED GAUSSIAN superposition for initializing NGWFs
! NOTE: MAKE SURE TO CHECK CHARGE OF SYSTEM AS WELL AS FINE_GRID_SCALE

 cutoff_energy       : 800 eV       ! was set to 800 in thesis calculations
 xc_functional XCNAME                  ! choice of functional
 task SINGLEPOINT                   ! set task to single point calculation
 write_xyz true                     ! write xyz coord file for visualization
 output_detail VERBOSE              ! control verbosity of output detail

 ngwf_threshold_orig : 0.000002     ! specifies convergence threshold for RMS gradient of NGWFs, default value 2.0E-6 
 kernel_cutoff       : 1000         ! specifies density kernel spatial cutoff, default value, bohr
 k_zero              : 3.5          ! kinetic energy preconditioning [expert] defaut is 3.0 bohr, why is different value used here? 

 elec_cg_max 0         ! sets max num of NGWF conjugate gradient iterations between resets, default value is 3
                       ! zero seems to correspond to steepest decent???
 occ_mix 1.0           ! frac of NGWF grad to which occupancy preconditioning is applies, default 0.25
                       ! value of 1 means fully preconditioned gradient
 dispersion DISPNUM          ! choice of damping function used in dispersion correction, Which is the current hip one?
 
 maxit_ngwf_cg 40      ! max number of iteration for NGWF conjugate gradients optimization
 
 minit_lnv 10          ! min and max number of iterations for density kerner optimization
 maxit_lnv 10 
 
 write_denskern F        ! will write desity kernal for restarts
 write_tightbox_ngwfs F  ! will write ngwfs for restart

 
 ! set system charge
 charge 9 ! set to 9 for host and complex, zero for ligand, but this is system dependent
 
 ! Turns on solvation
 is_implicit_solvent T      ! turn on implicit solvent, include is_auto_solvation to do all in one calc
 is_auto_solvation T        ! do vac calc then solvent calc all in one
 is_include_apolar T        ! new keyword to inlcude cavitation is is_include_apolar , but has same meaning as is_include_cavitation
 is_smeared_ion_rep T       ! turns of smeared ion representation, see documentation for solvent, needed in solvent and vac calc 
 
 ! Parameters of the implicit solvent model 
 is_solvent_surf_tension 4.7624E-5 Ha/bohr**2 ! specifies actual physical surface tension of solvent, water is default 4.7624E-5 Ha/bohr**2
 is_apolar_scaling_factor 0.281075            ! also need is_apolar_scaling_factor x in new version to include solute-solvent dispersion-repulsion, default 0.281075
 is_solvation_beta 1.3                        ! sets solvation param beta, no units, default is 1.3
 is_density_threshold 0.00035                 ! sets solvation param p_o in atomic units, this is default
 is_bulk_permittivity 78.54                   ! sets epsilon_infitiy, ie bulk permittivity, default 78.54 for water at room temp
 is_dielectric_model fix_initial              ! picks either fixed cavity of self-consistently changing cavity 
 
 ! Numerical details
 is_smeared_ion_width 0.8   ! sets width of smeared ion guassian, in bohr, deafult is 0.8
 mg_defco_fd_order 8        ! set mg discretization order, default 8
 is_bc_coarseness 10         ! advance parameter for numerical solver of NPB, changes size of course grain blocks for charge at boundary
                            ! 5 is default, can decrease for small molecule, and increase to 7 for moleculre with 1000+ atoms, lower cost
 is_bc_surface_coarseness 1 ! size of surface block to put charge four boundary interpolation, default 1, dont change
 !! mg_max_iters_defco 30      ! default 30,doubles max number of higher-order defect correction iterations
 fine_grid_scale 2.0        ! makes fine grid finer

 
 %block species
 N   N   7 4 8.0
 H   H   1 1 8.0
 C   C   6 4 8.0
 S   S  16 9 8.0
 O   O   8 4 8.0
 %endblock species
 
 
 %block species_pot
 N   N_00.recpot
 H   H_04.recpot
 C   C_01.recpot
 S   S_00.recpot
 O   O_02.recpot
 %endblock species_pot
 
